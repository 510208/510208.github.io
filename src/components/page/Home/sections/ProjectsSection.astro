---
import { ProjectsList } from "@components/page/Home/compose/projects/ProjectsList";
import { Image } from "astro:assets";

import cfbotLogo from "@/assets/pages/projects/cfbot_logo.svg";
import shblogLogo from "@/assets/pages/projects/shblog-next_logo.svg";
---

<head>
  <link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css"
  />
</head>
<div>
  <!-- 顯示專案的Logo -->
  <div class="hidden lg:flex justify-center align-middle gap-4">
    <a
      href="https://github.com/510208/cfbot"
      class="sh-project-card flex justify-center align-middle"
    >
      <Image
        src={cfbotLogo}
        alt="CFBot Logo"
        height={100}
        class="invert-100 opacity-20 hover:opacity-100 transition-opacity duration-300"
        loading="lazy"
      />
    </a>
    <a
      href="https://github.com/510208/sh-blog-next"
      class="sh-project-card flex justify-center align-middle"
    >
      <Image
        src={shblogLogo}
        alt="SHBlog Next Logo"
        height={70}
        class="opacity-20 hover:opacity-100 transition-opacity duration-300"
        loading="lazy"
      />
    </a>
  </div>
  <!-- 手機板顯示專案列表 -->
  <div class="block lg:hidden">
    <ProjectsList showFilter={false} maxCards={1} client:load />
  </div>
</div>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // 等待 React 組件渲染完成
    setTimeout(() => {
      const projectCards = document.querySelectorAll(".sh-project-card");

      if (projectCards.length > 0) {
        // 設定初始狀態
        gsap.set(projectCards, {
          opacity: 0,
          y: 30,
          scale: 0.98,
          transformOrigin: "center",
        });

        // 創建動畫時間線
        const tl = gsap.timeline({
          scrollTrigger: {
            trigger: ".sh-project-card",
            start: "top 80%",
            toggleActions: "play none none reverse",
          },
        });

        // 逐張卡片動畫
        projectCards.forEach((card, index) => {
          tl.to(
            card,
            {
              duration: 0.6,
              opacity: 1,
              y: 0,
              scale: 1,
              ease: "power2.out",
            },
            index === 0 ? 0 : "-=0.2",
          );
        });

        // 動畫完成後清理 will-change
        tl.call(() => {
          projectCards.forEach((card) => {
            const element = card as HTMLElement;
            if (element) {
              element.style.willChange = "auto";
            }
          });
        });
      }
    }, 1000);
  });
</script>
