---
import { cn } from "@/lib/utils";

interface Props<T = any> {
  items?: T[];
  className?: string;
  itemClassName?: string;
  columnGap?: number | string;
  // 在 Astro 中，key 通常由標記語言自動處理，但保留介面一致性
}

const { items, className, itemClassName, columnGap } = Astro.props;

// 處理 Inline Style
const style =
  columnGap !== undefined
    ? {
        columnGap: typeof columnGap === "number" ? `${columnGap}px` : columnGap,
      }
    : {};
---

<div
  class={cn("columns-1 sm:columns-2 lg:columns-3 [column-gap:1rem]", className)}
  style={style}
>
  {
    /* Astro 鼓勵直接在標籤內 map。
      如果傳入 items，我們在此遍歷；
      如果沒有傳入 items，則渲染預設的 <slot />
  */
  }
  {items ? <slot /> : <slot />}
</div>

<style is:global>
  /* 確保瀑布流內部的項目不會被截斷 */
  .break-inside-avoid {
    break-inside: avoid-column;
    display: inline-block; /* 增加相容性 */
    width: 100%; /* 確保寬度填滿欄位 */
    margin-bottom: 1rem; /* 對應原組件的 mb-4 */
  }
</style>
